/// Makes an element's :before pseudoelement a FontAwesome icon.
/// @param {string} $content Optional content value to use.
/// @param {string} $where Optional pseudoelement to target (before or after).
@mixin icon($content: false, $where: before) {
  text-decoration: none;

  &:#{$where} {
    @if $content {
      content: $content;
    }

    -moz-osx-font-smoothing: grayscale;
    -webkit-font-smoothing: antialiased;
    font-family: FontAwesome;
    font-style: normal;
    font-weight: normal;
    text-transform: none !important;
  }
}

/// Applies padding to an element, taking the current element-margin value into account.
/// @param {mixed} $tb Top/bottom padding.
/// @param {mixed} $lr Left/right padding.
/// @param {list} $pad Optional extra padding (in the following order top, right, bottom, left)
/// @param {bool} $important If true, adds !important.
@mixin padding($tb, $lr, $pad: (0, 0, 0, 0), $important: null) {
  @if $important {
    $important: '!important';
  }

  $x: 0.1em;

  @if unit(_size(element-margin)) == 'rem' {
    $x: 0.1rem;
  }

  padding: ($tb + nth($pad, 1)) ($lr + nth($pad, 2)) max($x, $tb - _size(element-margin) + nth($pad, 3))
    ($lr + nth($pad, 4)) #{$important};
}

// Applies a pulsating border effect on :active
@mixin pulseBorder() {
  outline: none;
  border: 1px solid transparent;

  &:active,
  &:focus {
    animation: pulse 2s infinite;
  }
}

/// Encodes a SVG data URL so IE doesn't choke (via codepen.io/jakob-e/pen/YXXBrp).
/// @param {string} $svg SVG data URL.
/// @return {string} Encoded SVG data URL.
@function svg-url($svg) {
  $svg: str-replace($svg, '"', "'");
  $svg: str-replace($svg, '%', '%25');
  $svg: str-replace($svg, '<', '%3C');
  $svg: str-replace($svg, '>', '%3E');
  $svg: str-replace($svg, '&', '%26');
  $svg: str-replace($svg, '#', '%23');
  $svg: str-replace($svg, '{', '%7B');
  $svg: str-replace($svg, '}', '%7D');
  $svg: str-replace($svg, ';', '%3B');

  @return url('data:image/svg+xml;charset=utf8,#{$svg}');
}

// Declare as mixin because the style declarations cannot be grouped together.
@mixin txt-placeholder-shadow($color) {
  text-shadow: _palette(txt-shadow);
  // color: $color !important;
  opacity: 0.75;
}

// Implementation of themes
@mixin themify() {
  @each $theme, $map in $themes {
    .theme--#{$theme} & {
      $theme-map: () !global;
      @each $key, $submap in $map {
        $value: map-get(map-get($themes, $theme), '#{$key}');
        $theme-map: map-merge(
          $theme-map,
          (
            $key: $value
          )
        ) !global;
      }
      @content;
      $theme-map: null !global;
    }
  }
}

@function themed($key) {
  @return map-get($theme-map, $key);
}

@mixin dimmedCard() {
  @include vendor('transform-origin', '50% 50%');
  @include vendor('transform', 'rotateX(0deg)');
  @include vendor('transition', ('opacity #{_duration(main)} ease', 'transform #{_duration(main)} ease'));
  @include padding(4.5em, 3em);
  background: _palette(bg-transparent-dim);
  border-radius: _size(border-radius);
  cursor: default;
  max-width: 100vw;
  min-width: 225px;
  opacity: 0.95;
  position: relative;
  text-align: center;
  width: 27em;
  transition: background 1s;

  p,
  h1 {
    @include vendor('transition', ('color #{_duration(main)} ease'));
    @include themify() {
      color: themed('fadedCardTxt');
    }
  }

  h1 {
    text-shadow: none;
    font-weight: 500;
  }

  & ul.icons li {
    & a,
    & a:before {
      transition: color 1s, border 1s;
    }
  }

  &:hover {
    background: _palette(bg-transparent-bright);

    p {
      color: $onyx;
    }

    h1 {
      @include themify() {
        color: themed('fadedCardTxtHover');
      }
    }

    & ul.icons li a {
      border: solid _size(border-width) _palette(border-dark);

      &:before {
        color: _palette(border-dark);
      }
    }
  }
}

@mixin transition($duration) {
  -webkit-transition: $duration;
  -moz-transition: $duration;
  -ms-transition: $duration;
  -o-transition: $duration;
  transition: $duration;
}
